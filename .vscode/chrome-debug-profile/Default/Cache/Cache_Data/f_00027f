import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/modules/object-record/object-filter-dropdown/components/ObjectFilterDropdownSourceSelect.tsx");if (!window.$RefreshReg$) throw new Error("React refresh preamble was not loaded. Something is wrong.");
const prevRefreshReg = window.$RefreshReg$;
const prevRefreshSig = window.$RefreshSig$;
window.$RefreshReg$ = RefreshRuntime.getRefreshReg("D:/twenty-table-o/packages/twenty-front/src/modules/object-record/object-filter-dropdown/components/ObjectFilterDropdownSourceSelect.tsx");
window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;

import * as RefreshRuntime from "/@react-refresh";

import { jsxDEV as _jsxDEV } from "/@fs/D:/twenty-table-o/node_modules/.vite/packages/twenty-front/deps/@emotion_react_jsx-dev-runtime.js?v=226f7286";
var _s = $RefreshSig$();
import { getFilterTypeFromFieldType } from "/src/modules/object-metadata/utils/formatFieldMetadataItemsAsFilterDefinitions.ts";
import { fieldMetadataItemUsedInDropdownComponentSelector } from "/src/modules/object-record/object-filter-dropdown/states/fieldMetadataItemUsedInDropdownComponentSelector.ts";
import { objectFilterDropdownSearchInputComponentState } from "/src/modules/object-record/object-filter-dropdown/states/objectFilterDropdownSearchInputComponentState.ts";
import { objectFilterDropdownSelectedRecordIdsComponentState } from "/src/modules/object-record/object-filter-dropdown/states/objectFilterDropdownSelectedRecordIdsComponentState.ts";
import { selectedFilterComponentState } from "/src/modules/object-record/object-filter-dropdown/states/selectedFilterComponentState.ts";
import { selectedOperandInDropdownComponentState } from "/src/modules/object-record/object-filter-dropdown/states/selectedOperandInDropdownComponentState.ts";
import { getActorSourceMultiSelectOptions } from "/src/modules/object-record/object-filter-dropdown/utils/getActorSourceMultiSelectOptions.ts";
import { useApplyRecordFilter } from "/src/modules/object-record/record-filter/hooks/useApplyRecordFilter.ts";
import { currentRecordFiltersComponentState } from "/src/modules/object-record/record-filter/states/currentRecordFiltersComponentState.ts";
import { findDuplicateRecordFilterInNonAdvancedRecordFilters } from "/src/modules/object-record/record-filter/utils/findDuplicateRecordFilterInNonAdvancedRecordFilters.ts";
import { SingleRecordPickerHotkeyScope } from "/src/modules/object-record/record-picker/single-record-picker/types/SingleRecordPickerHotkeyScope.ts";
import { MultipleSelectDropdown } from "/src/modules/object-record/select/components/MultipleSelectDropdown.tsx";
import { useRecoilComponentValueV2 } from "/src/modules/ui/utilities/state/component-state/hooks/useRecoilComponentValueV2.ts";
import { useSetRecoilComponentStateV2 } from "/src/modules/ui/utilities/state/component-state/hooks/useSetRecoilComponentStateV2.ts";
import { ViewFilterOperand } from "/src/modules/views/types/ViewFilterOperand.ts";
import { isDefined } from "/@fs/D:/twenty-table-o/packages/twenty-shared/utils/dist/twenty-shared-utils.esm.js";
import { v4 } from "/@fs/D:/twenty-table-o/node_modules/.vite/packages/twenty-front/deps/uuid.js?v=226f7286";
export const EMPTY_FILTER_VALUE = '[]';
export const MAX_ITEMS_TO_DISPLAY = 3;
export const ObjectFilterDropdownSourceSelect = ({ viewComponentId })=>{
    _s();
    const objectFilterDropdownSearchInput = useRecoilComponentValueV2(objectFilterDropdownSearchInputComponentState);
    const setObjectFilterDropdownSelectedRecordIds = useSetRecoilComponentStateV2(objectFilterDropdownSelectedRecordIdsComponentState);
    const objectFilterDropdownSelectedRecordIds = useRecoilComponentValueV2(objectFilterDropdownSelectedRecordIdsComponentState);
    const selectedFilter = useRecoilComponentValueV2(selectedFilterComponentState);
    const selectedOperandInDropdown = useRecoilComponentValueV2(selectedOperandInDropdownComponentState);
    const fieldMetadataItemUsedInFilterDropdown = useRecoilComponentValueV2(fieldMetadataItemUsedInDropdownComponentSelector);
    const { applyRecordFilter } = useApplyRecordFilter(viewComponentId);
    const sourceTypes = getActorSourceMultiSelectOptions(objectFilterDropdownSelectedRecordIds);
    const filteredSelectedItems = sourceTypes.filter((option)=>objectFilterDropdownSelectedRecordIds.includes(option.id));
    const currentRecordFilters = useRecoilComponentValueV2(currentRecordFiltersComponentState);
    const handleMultipleItemSelectChange = (itemToSelect, newSelectedValue)=>{
        const newSelectedItemIds = newSelectedValue ? [
            ...objectFilterDropdownSelectedRecordIds,
            itemToSelect.id
        ] : objectFilterDropdownSelectedRecordIds.filter((id)=>id !== itemToSelect.id);
        if (!isDefined(fieldMetadataItemUsedInFilterDropdown)) {
            throw new Error('Field metadata item used in filter dropdown should be defined');
        }
        setObjectFilterDropdownSelectedRecordIds(newSelectedItemIds);
        const selectedItemNames = sourceTypes.filter((option)=>newSelectedItemIds.includes(option.id)).map((option)=>option.name);
        const filterDisplayValue = selectedItemNames.length > MAX_ITEMS_TO_DISPLAY ? `${selectedItemNames.length} source types` : selectedItemNames.join(', ');
        if (isDefined(fieldMetadataItemUsedInFilterDropdown) && isDefined(selectedOperandInDropdown)) {
            const newFilterValue = newSelectedItemIds.length > 0 ? JSON.stringify(newSelectedItemIds) : EMPTY_FILTER_VALUE;
            const duplicateFilterInCurrentRecordFilters = findDuplicateRecordFilterInNonAdvancedRecordFilters({
                recordFilters: currentRecordFilters,
                fieldMetadataItemId: fieldMetadataItemUsedInFilterDropdown.id,
                subFieldName: 'source'
            });
            const filterIsAlreadyInCurrentRecordFilters = isDefined(duplicateFilterInCurrentRecordFilters);
            const filterId = filterIsAlreadyInCurrentRecordFilters ? duplicateFilterInCurrentRecordFilters?.id : v4();
            applyRecordFilter({
                id: selectedFilter?.id ? selectedFilter.id : filterId,
                type: getFilterTypeFromFieldType(fieldMetadataItemUsedInFilterDropdown.type),
                label: fieldMetadataItemUsedInFilterDropdown.label,
                operand: selectedOperandInDropdown || ViewFilterOperand.Is,
                displayValue: filterDisplayValue,
                fieldMetadataId: fieldMetadataItemUsedInFilterDropdown.id,
                value: newFilterValue,
                recordFilterGroupId: selectedFilter?.recordFilterGroupId,
                subFieldName: 'source',
                positionInRecordFilterGroup: selectedFilter?.positionInRecordFilterGroup
            });
        }
    };
    return /*#__PURE__*/ _jsxDEV(MultipleSelectDropdown, {
        selectableListId: "object-filter-source-select-id",
        hotkeyScope: SingleRecordPickerHotkeyScope.SingleRecordPicker,
        itemsToSelect: sourceTypes.filter((item)=>!filteredSelectedItems.some((selected)=>selected.id === item.id)),
        filteredSelectedItems: filteredSelectedItems,
        selectedItems: filteredSelectedItems,
        onChange: handleMultipleItemSelectChange,
        searchFilter: objectFilterDropdownSearchInput,
        loadingItems: false
    }, void 0, false, {
        fileName: "D:/twenty-table-o/packages/twenty-front/src/modules/object-record/object-filter-dropdown/components/ObjectFilterDropdownSourceSelect.tsx",
        lineNumber: 138,
        columnNumber: 5
    }, this);
};
_s(ObjectFilterDropdownSourceSelect, "zeyR2o6/qirkA3xSph2xu7i7Aq0=", false, function() {
    return [
        useRecoilComponentValueV2,
        useSetRecoilComponentStateV2,
        useRecoilComponentValueV2,
        useRecoilComponentValueV2,
        useRecoilComponentValueV2,
        useRecoilComponentValueV2,
        useApplyRecordFilter,
        useRecoilComponentValueV2
    ];
});
_c = ObjectFilterDropdownSourceSelect;
var _c;
$RefreshReg$(_c, "ObjectFilterDropdownSourceSelect");


window.$RefreshReg$ = prevRefreshReg;
window.$RefreshSig$ = prevRefreshSig;

RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
  RefreshRuntime.registerExportsForReactRefresh("D:/twenty-table-o/packages/twenty-front/src/modules/object-record/object-filter-dropdown/components/ObjectFilterDropdownSourceSelect.tsx", currentExports);
  import.meta.hot.accept((nextExports) => {
    if (!nextExports) return;
    const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("D:/twenty-table-o/packages/twenty-front/src/modules/object-record/object-filter-dropdown/components/ObjectFilterDropdownSourceSelect.tsx", currentExports, nextExports);
    if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
  });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk9iamVjdEZpbHRlckRyb3Bkb3duU291cmNlU2VsZWN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRGaWx0ZXJUeXBlRnJvbUZpZWxkVHlwZSB9IGZyb20gJ0Avb2JqZWN0LW1ldGFkYXRhL3V0aWxzL2Zvcm1hdEZpZWxkTWV0YWRhdGFJdGVtc0FzRmlsdGVyRGVmaW5pdGlvbnMnO1xuaW1wb3J0IHsgZmllbGRNZXRhZGF0YUl0ZW1Vc2VkSW5Ecm9wZG93bkNvbXBvbmVudFNlbGVjdG9yIH0gZnJvbSAnQC9vYmplY3QtcmVjb3JkL29iamVjdC1maWx0ZXItZHJvcGRvd24vc3RhdGVzL2ZpZWxkTWV0YWRhdGFJdGVtVXNlZEluRHJvcGRvd25Db21wb25lbnRTZWxlY3Rvcic7XG5pbXBvcnQgeyBvYmplY3RGaWx0ZXJEcm9wZG93blNlYXJjaElucHV0Q29tcG9uZW50U3RhdGUgfSBmcm9tICdAL29iamVjdC1yZWNvcmQvb2JqZWN0LWZpbHRlci1kcm9wZG93bi9zdGF0ZXMvb2JqZWN0RmlsdGVyRHJvcGRvd25TZWFyY2hJbnB1dENvbXBvbmVudFN0YXRlJztcbmltcG9ydCB7IG9iamVjdEZpbHRlckRyb3Bkb3duU2VsZWN0ZWRSZWNvcmRJZHNDb21wb25lbnRTdGF0ZSB9IGZyb20gJ0Avb2JqZWN0LXJlY29yZC9vYmplY3QtZmlsdGVyLWRyb3Bkb3duL3N0YXRlcy9vYmplY3RGaWx0ZXJEcm9wZG93blNlbGVjdGVkUmVjb3JkSWRzQ29tcG9uZW50U3RhdGUnO1xuaW1wb3J0IHsgc2VsZWN0ZWRGaWx0ZXJDb21wb25lbnRTdGF0ZSB9IGZyb20gJ0Avb2JqZWN0LXJlY29yZC9vYmplY3QtZmlsdGVyLWRyb3Bkb3duL3N0YXRlcy9zZWxlY3RlZEZpbHRlckNvbXBvbmVudFN0YXRlJztcbmltcG9ydCB7IHNlbGVjdGVkT3BlcmFuZEluRHJvcGRvd25Db21wb25lbnRTdGF0ZSB9IGZyb20gJ0Avb2JqZWN0LXJlY29yZC9vYmplY3QtZmlsdGVyLWRyb3Bkb3duL3N0YXRlcy9zZWxlY3RlZE9wZXJhbmRJbkRyb3Bkb3duQ29tcG9uZW50U3RhdGUnO1xuaW1wb3J0IHsgZ2V0QWN0b3JTb3VyY2VNdWx0aVNlbGVjdE9wdGlvbnMgfSBmcm9tICdAL29iamVjdC1yZWNvcmQvb2JqZWN0LWZpbHRlci1kcm9wZG93bi91dGlscy9nZXRBY3RvclNvdXJjZU11bHRpU2VsZWN0T3B0aW9ucyc7XG5pbXBvcnQgeyB1c2VBcHBseVJlY29yZEZpbHRlciB9IGZyb20gJ0Avb2JqZWN0LXJlY29yZC9yZWNvcmQtZmlsdGVyL2hvb2tzL3VzZUFwcGx5UmVjb3JkRmlsdGVyJztcbmltcG9ydCB7IGN1cnJlbnRSZWNvcmRGaWx0ZXJzQ29tcG9uZW50U3RhdGUgfSBmcm9tICdAL29iamVjdC1yZWNvcmQvcmVjb3JkLWZpbHRlci9zdGF0ZXMvY3VycmVudFJlY29yZEZpbHRlcnNDb21wb25lbnRTdGF0ZSc7XG5pbXBvcnQgeyBmaW5kRHVwbGljYXRlUmVjb3JkRmlsdGVySW5Ob25BZHZhbmNlZFJlY29yZEZpbHRlcnMgfSBmcm9tICdAL29iamVjdC1yZWNvcmQvcmVjb3JkLWZpbHRlci91dGlscy9maW5kRHVwbGljYXRlUmVjb3JkRmlsdGVySW5Ob25BZHZhbmNlZFJlY29yZEZpbHRlcnMnO1xuaW1wb3J0IHsgU2luZ2xlUmVjb3JkUGlja2VySG90a2V5U2NvcGUgfSBmcm9tICdAL29iamVjdC1yZWNvcmQvcmVjb3JkLXBpY2tlci9zaW5nbGUtcmVjb3JkLXBpY2tlci90eXBlcy9TaW5nbGVSZWNvcmRQaWNrZXJIb3RrZXlTY29wZSc7XG5pbXBvcnQgeyBNdWx0aXBsZVNlbGVjdERyb3Bkb3duIH0gZnJvbSAnQC9vYmplY3QtcmVjb3JkL3NlbGVjdC9jb21wb25lbnRzL011bHRpcGxlU2VsZWN0RHJvcGRvd24nO1xuaW1wb3J0IHsgU2VsZWN0YWJsZUl0ZW0gfSBmcm9tICdAL29iamVjdC1yZWNvcmQvc2VsZWN0L3R5cGVzL1NlbGVjdGFibGVJdGVtJztcbmltcG9ydCB7IHVzZVJlY29pbENvbXBvbmVudFZhbHVlVjIgfSBmcm9tICdAL3VpL3V0aWxpdGllcy9zdGF0ZS9jb21wb25lbnQtc3RhdGUvaG9va3MvdXNlUmVjb2lsQ29tcG9uZW50VmFsdWVWMic7XG5pbXBvcnQgeyB1c2VTZXRSZWNvaWxDb21wb25lbnRTdGF0ZVYyIH0gZnJvbSAnQC91aS91dGlsaXRpZXMvc3RhdGUvY29tcG9uZW50LXN0YXRlL2hvb2tzL3VzZVNldFJlY29pbENvbXBvbmVudFN0YXRlVjInO1xuaW1wb3J0IHsgVmlld0ZpbHRlck9wZXJhbmQgfSBmcm9tICdAL3ZpZXdzL3R5cGVzL1ZpZXdGaWx0ZXJPcGVyYW5kJztcbmltcG9ydCB7IGlzRGVmaW5lZCB9IGZyb20gJ3R3ZW50eS1zaGFyZWQvdXRpbHMnO1xuaW1wb3J0IHsgdjQgfSBmcm9tICd1dWlkJztcblxuZXhwb3J0IGNvbnN0IEVNUFRZX0ZJTFRFUl9WQUxVRSA9ICdbXSc7XG5leHBvcnQgY29uc3QgTUFYX0lURU1TX1RPX0RJU1BMQVkgPSAzO1xuXG50eXBlIE9iamVjdEZpbHRlckRyb3Bkb3duU291cmNlU2VsZWN0UHJvcHMgPSB7XG4gIHZpZXdDb21wb25lbnRJZD86IHN0cmluZztcbn07XG5cbmV4cG9ydCBjb25zdCBPYmplY3RGaWx0ZXJEcm9wZG93blNvdXJjZVNlbGVjdCA9ICh7XG4gIHZpZXdDb21wb25lbnRJZCxcbn06IE9iamVjdEZpbHRlckRyb3Bkb3duU291cmNlU2VsZWN0UHJvcHMpID0+IHtcbiAgY29uc3Qgb2JqZWN0RmlsdGVyRHJvcGRvd25TZWFyY2hJbnB1dCA9IHVzZVJlY29pbENvbXBvbmVudFZhbHVlVjIoXG4gICAgb2JqZWN0RmlsdGVyRHJvcGRvd25TZWFyY2hJbnB1dENvbXBvbmVudFN0YXRlLFxuICApO1xuXG4gIGNvbnN0IHNldE9iamVjdEZpbHRlckRyb3Bkb3duU2VsZWN0ZWRSZWNvcmRJZHMgPSB1c2VTZXRSZWNvaWxDb21wb25lbnRTdGF0ZVYyKFxuICAgIG9iamVjdEZpbHRlckRyb3Bkb3duU2VsZWN0ZWRSZWNvcmRJZHNDb21wb25lbnRTdGF0ZSxcbiAgKTtcblxuICBjb25zdCBvYmplY3RGaWx0ZXJEcm9wZG93blNlbGVjdGVkUmVjb3JkSWRzID0gdXNlUmVjb2lsQ29tcG9uZW50VmFsdWVWMihcbiAgICBvYmplY3RGaWx0ZXJEcm9wZG93blNlbGVjdGVkUmVjb3JkSWRzQ29tcG9uZW50U3RhdGUsXG4gICk7XG5cbiAgY29uc3Qgc2VsZWN0ZWRGaWx0ZXIgPSB1c2VSZWNvaWxDb21wb25lbnRWYWx1ZVYyKFxuICAgIHNlbGVjdGVkRmlsdGVyQ29tcG9uZW50U3RhdGUsXG4gICk7XG5cbiAgY29uc3Qgc2VsZWN0ZWRPcGVyYW5kSW5Ecm9wZG93biA9IHVzZVJlY29pbENvbXBvbmVudFZhbHVlVjIoXG4gICAgc2VsZWN0ZWRPcGVyYW5kSW5Ecm9wZG93bkNvbXBvbmVudFN0YXRlLFxuICApO1xuXG4gIGNvbnN0IGZpZWxkTWV0YWRhdGFJdGVtVXNlZEluRmlsdGVyRHJvcGRvd24gPSB1c2VSZWNvaWxDb21wb25lbnRWYWx1ZVYyKFxuICAgIGZpZWxkTWV0YWRhdGFJdGVtVXNlZEluRHJvcGRvd25Db21wb25lbnRTZWxlY3RvcixcbiAgKTtcblxuICBjb25zdCB7IGFwcGx5UmVjb3JkRmlsdGVyIH0gPSB1c2VBcHBseVJlY29yZEZpbHRlcih2aWV3Q29tcG9uZW50SWQpO1xuXG4gIGNvbnN0IHNvdXJjZVR5cGVzID0gZ2V0QWN0b3JTb3VyY2VNdWx0aVNlbGVjdE9wdGlvbnMoXG4gICAgb2JqZWN0RmlsdGVyRHJvcGRvd25TZWxlY3RlZFJlY29yZElkcyxcbiAgKTtcblxuICBjb25zdCBmaWx0ZXJlZFNlbGVjdGVkSXRlbXMgPSBzb3VyY2VUeXBlcy5maWx0ZXIoKG9wdGlvbikgPT5cbiAgICBvYmplY3RGaWx0ZXJEcm9wZG93blNlbGVjdGVkUmVjb3JkSWRzLmluY2x1ZGVzKG9wdGlvbi5pZCksXG4gICk7XG5cbiAgY29uc3QgY3VycmVudFJlY29yZEZpbHRlcnMgPSB1c2VSZWNvaWxDb21wb25lbnRWYWx1ZVYyKFxuICAgIGN1cnJlbnRSZWNvcmRGaWx0ZXJzQ29tcG9uZW50U3RhdGUsXG4gICk7XG5cbiAgY29uc3QgaGFuZGxlTXVsdGlwbGVJdGVtU2VsZWN0Q2hhbmdlID0gKFxuICAgIGl0ZW1Ub1NlbGVjdDogU2VsZWN0YWJsZUl0ZW0sXG4gICAgbmV3U2VsZWN0ZWRWYWx1ZTogYm9vbGVhbixcbiAgKSA9PiB7XG4gICAgY29uc3QgbmV3U2VsZWN0ZWRJdGVtSWRzID0gbmV3U2VsZWN0ZWRWYWx1ZVxuICAgICAgPyBbLi4ub2JqZWN0RmlsdGVyRHJvcGRvd25TZWxlY3RlZFJlY29yZElkcywgaXRlbVRvU2VsZWN0LmlkXVxuICAgICAgOiBvYmplY3RGaWx0ZXJEcm9wZG93blNlbGVjdGVkUmVjb3JkSWRzLmZpbHRlcihcbiAgICAgICAgICAoaWQpID0+IGlkICE9PSBpdGVtVG9TZWxlY3QuaWQsXG4gICAgICAgICk7XG5cbiAgICBpZiAoIWlzRGVmaW5lZChmaWVsZE1ldGFkYXRhSXRlbVVzZWRJbkZpbHRlckRyb3Bkb3duKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAnRmllbGQgbWV0YWRhdGEgaXRlbSB1c2VkIGluIGZpbHRlciBkcm9wZG93biBzaG91bGQgYmUgZGVmaW5lZCcsXG4gICAgICApO1xuICAgIH1cblxuICAgIHNldE9iamVjdEZpbHRlckRyb3Bkb3duU2VsZWN0ZWRSZWNvcmRJZHMobmV3U2VsZWN0ZWRJdGVtSWRzKTtcblxuICAgIGNvbnN0IHNlbGVjdGVkSXRlbU5hbWVzID0gc291cmNlVHlwZXNcbiAgICAgIC5maWx0ZXIoKG9wdGlvbikgPT4gbmV3U2VsZWN0ZWRJdGVtSWRzLmluY2x1ZGVzKG9wdGlvbi5pZCkpXG4gICAgICAubWFwKChvcHRpb24pID0+IG9wdGlvbi5uYW1lKTtcblxuICAgIGNvbnN0IGZpbHRlckRpc3BsYXlWYWx1ZSA9XG4gICAgICBzZWxlY3RlZEl0ZW1OYW1lcy5sZW5ndGggPiBNQVhfSVRFTVNfVE9fRElTUExBWVxuICAgICAgICA/IGAke3NlbGVjdGVkSXRlbU5hbWVzLmxlbmd0aH0gc291cmNlIHR5cGVzYFxuICAgICAgICA6IHNlbGVjdGVkSXRlbU5hbWVzLmpvaW4oJywgJyk7XG5cbiAgICBpZiAoXG4gICAgICBpc0RlZmluZWQoZmllbGRNZXRhZGF0YUl0ZW1Vc2VkSW5GaWx0ZXJEcm9wZG93bikgJiZcbiAgICAgIGlzRGVmaW5lZChzZWxlY3RlZE9wZXJhbmRJbkRyb3Bkb3duKVxuICAgICkge1xuICAgICAgY29uc3QgbmV3RmlsdGVyVmFsdWUgPVxuICAgICAgICBuZXdTZWxlY3RlZEl0ZW1JZHMubGVuZ3RoID4gMFxuICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkobmV3U2VsZWN0ZWRJdGVtSWRzKVxuICAgICAgICAgIDogRU1QVFlfRklMVEVSX1ZBTFVFO1xuXG4gICAgICBjb25zdCBkdXBsaWNhdGVGaWx0ZXJJbkN1cnJlbnRSZWNvcmRGaWx0ZXJzID1cbiAgICAgICAgZmluZER1cGxpY2F0ZVJlY29yZEZpbHRlckluTm9uQWR2YW5jZWRSZWNvcmRGaWx0ZXJzKHtcbiAgICAgICAgICByZWNvcmRGaWx0ZXJzOiBjdXJyZW50UmVjb3JkRmlsdGVycyxcbiAgICAgICAgICBmaWVsZE1ldGFkYXRhSXRlbUlkOiBmaWVsZE1ldGFkYXRhSXRlbVVzZWRJbkZpbHRlckRyb3Bkb3duLmlkLFxuICAgICAgICAgIHN1YkZpZWxkTmFtZTogJ3NvdXJjZScsXG4gICAgICAgIH0pO1xuXG4gICAgICBjb25zdCBmaWx0ZXJJc0FscmVhZHlJbkN1cnJlbnRSZWNvcmRGaWx0ZXJzID0gaXNEZWZpbmVkKFxuICAgICAgICBkdXBsaWNhdGVGaWx0ZXJJbkN1cnJlbnRSZWNvcmRGaWx0ZXJzLFxuICAgICAgKTtcblxuICAgICAgY29uc3QgZmlsdGVySWQgPSBmaWx0ZXJJc0FscmVhZHlJbkN1cnJlbnRSZWNvcmRGaWx0ZXJzXG4gICAgICAgID8gZHVwbGljYXRlRmlsdGVySW5DdXJyZW50UmVjb3JkRmlsdGVycz8uaWRcbiAgICAgICAgOiB2NCgpO1xuXG4gICAgICBhcHBseVJlY29yZEZpbHRlcih7XG4gICAgICAgIGlkOiBzZWxlY3RlZEZpbHRlcj8uaWQgPyBzZWxlY3RlZEZpbHRlci5pZCA6IGZpbHRlcklkLFxuICAgICAgICB0eXBlOiBnZXRGaWx0ZXJUeXBlRnJvbUZpZWxkVHlwZShcbiAgICAgICAgICBmaWVsZE1ldGFkYXRhSXRlbVVzZWRJbkZpbHRlckRyb3Bkb3duLnR5cGUsXG4gICAgICAgICksXG4gICAgICAgIGxhYmVsOiBmaWVsZE1ldGFkYXRhSXRlbVVzZWRJbkZpbHRlckRyb3Bkb3duLmxhYmVsLFxuICAgICAgICBvcGVyYW5kOiBzZWxlY3RlZE9wZXJhbmRJbkRyb3Bkb3duIHx8IFZpZXdGaWx0ZXJPcGVyYW5kLklzLFxuICAgICAgICBkaXNwbGF5VmFsdWU6IGZpbHRlckRpc3BsYXlWYWx1ZSxcbiAgICAgICAgZmllbGRNZXRhZGF0YUlkOiBmaWVsZE1ldGFkYXRhSXRlbVVzZWRJbkZpbHRlckRyb3Bkb3duLmlkLFxuICAgICAgICB2YWx1ZTogbmV3RmlsdGVyVmFsdWUsXG4gICAgICAgIHJlY29yZEZpbHRlckdyb3VwSWQ6IHNlbGVjdGVkRmlsdGVyPy5yZWNvcmRGaWx0ZXJHcm91cElkLFxuICAgICAgICBzdWJGaWVsZE5hbWU6ICdzb3VyY2UnLFxuICAgICAgICBwb3NpdGlvbkluUmVjb3JkRmlsdGVyR3JvdXA6XG4gICAgICAgICAgc2VsZWN0ZWRGaWx0ZXI/LnBvc2l0aW9uSW5SZWNvcmRGaWx0ZXJHcm91cCxcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxNdWx0aXBsZVNlbGVjdERyb3Bkb3duXG4gICAgICBzZWxlY3RhYmxlTGlzdElkPVwib2JqZWN0LWZpbHRlci1zb3VyY2Utc2VsZWN0LWlkXCJcbiAgICAgIGhvdGtleVNjb3BlPXtTaW5nbGVSZWNvcmRQaWNrZXJIb3RrZXlTY29wZS5TaW5nbGVSZWNvcmRQaWNrZXJ9XG4gICAgICBpdGVtc1RvU2VsZWN0PXtzb3VyY2VUeXBlcy5maWx0ZXIoXG4gICAgICAgIChpdGVtKSA9PlxuICAgICAgICAgICFmaWx0ZXJlZFNlbGVjdGVkSXRlbXMuc29tZSgoc2VsZWN0ZWQpID0+IHNlbGVjdGVkLmlkID09PSBpdGVtLmlkKSxcbiAgICAgICl9XG4gICAgICBmaWx0ZXJlZFNlbGVjdGVkSXRlbXM9e2ZpbHRlcmVkU2VsZWN0ZWRJdGVtc31cbiAgICAgIHNlbGVjdGVkSXRlbXM9e2ZpbHRlcmVkU2VsZWN0ZWRJdGVtc31cbiAgICAgIG9uQ2hhbmdlPXtoYW5kbGVNdWx0aXBsZUl0ZW1TZWxlY3RDaGFuZ2V9XG4gICAgICBzZWFyY2hGaWx0ZXI9e29iamVjdEZpbHRlckRyb3Bkb3duU2VhcmNoSW5wdXR9XG4gICAgICBsb2FkaW5nSXRlbXM9e2ZhbHNlfVxuICAgIC8+XG4gICk7XG59O1xuIl0sIm5hbWVzIjpbImdldEZpbHRlclR5cGVGcm9tRmllbGRUeXBlIiwiZmllbGRNZXRhZGF0YUl0ZW1Vc2VkSW5Ecm9wZG93bkNvbXBvbmVudFNlbGVjdG9yIiwib2JqZWN0RmlsdGVyRHJvcGRvd25TZWFyY2hJbnB1dENvbXBvbmVudFN0YXRlIiwib2JqZWN0RmlsdGVyRHJvcGRvd25TZWxlY3RlZFJlY29yZElkc0NvbXBvbmVudFN0YXRlIiwic2VsZWN0ZWRGaWx0ZXJDb21wb25lbnRTdGF0ZSIsInNlbGVjdGVkT3BlcmFuZEluRHJvcGRvd25Db21wb25lbnRTdGF0ZSIsImdldEFjdG9yU291cmNlTXVsdGlTZWxlY3RPcHRpb25zIiwidXNlQXBwbHlSZWNvcmRGaWx0ZXIiLCJjdXJyZW50UmVjb3JkRmlsdGVyc0NvbXBvbmVudFN0YXRlIiwiZmluZER1cGxpY2F0ZVJlY29yZEZpbHRlckluTm9uQWR2YW5jZWRSZWNvcmRGaWx0ZXJzIiwiU2luZ2xlUmVjb3JkUGlja2VySG90a2V5U2NvcGUiLCJNdWx0aXBsZVNlbGVjdERyb3Bkb3duIiwidXNlUmVjb2lsQ29tcG9uZW50VmFsdWVWMiIsInVzZVNldFJlY29pbENvbXBvbmVudFN0YXRlVjIiLCJWaWV3RmlsdGVyT3BlcmFuZCIsImlzRGVmaW5lZCIsInY0IiwiRU1QVFlfRklMVEVSX1ZBTFVFIiwiTUFYX0lURU1TX1RPX0RJU1BMQVkiLCJPYmplY3RGaWx0ZXJEcm9wZG93blNvdXJjZVNlbGVjdCIsInZpZXdDb21wb25lbnRJZCIsIm9iamVjdEZpbHRlckRyb3Bkb3duU2VhcmNoSW5wdXQiLCJzZXRPYmplY3RGaWx0ZXJEcm9wZG93blNlbGVjdGVkUmVjb3JkSWRzIiwib2JqZWN0RmlsdGVyRHJvcGRvd25TZWxlY3RlZFJlY29yZElkcyIsInNlbGVjdGVkRmlsdGVyIiwic2VsZWN0ZWRPcGVyYW5kSW5Ecm9wZG93biIsImZpZWxkTWV0YWRhdGFJdGVtVXNlZEluRmlsdGVyRHJvcGRvd24iLCJhcHBseVJlY29yZEZpbHRlciIsInNvdXJjZVR5cGVzIiwiZmlsdGVyZWRTZWxlY3RlZEl0ZW1zIiwiZmlsdGVyIiwib3B0aW9uIiwiaW5jbHVkZXMiLCJpZCIsImN1cnJlbnRSZWNvcmRGaWx0ZXJzIiwiaGFuZGxlTXVsdGlwbGVJdGVtU2VsZWN0Q2hhbmdlIiwiaXRlbVRvU2VsZWN0IiwibmV3U2VsZWN0ZWRWYWx1ZSIsIm5ld1NlbGVjdGVkSXRlbUlkcyIsIkVycm9yIiwic2VsZWN0ZWRJdGVtTmFtZXMiLCJtYXAiLCJuYW1lIiwiZmlsdGVyRGlzcGxheVZhbHVlIiwibGVuZ3RoIiwiam9pbiIsIm5ld0ZpbHRlclZhbHVlIiwiSlNPTiIsInN0cmluZ2lmeSIsImR1cGxpY2F0ZUZpbHRlckluQ3VycmVudFJlY29yZEZpbHRlcnMiLCJyZWNvcmRGaWx0ZXJzIiwiZmllbGRNZXRhZGF0YUl0ZW1JZCIsInN1YkZpZWxkTmFtZSIsImZpbHRlcklzQWxyZWFkeUluQ3VycmVudFJlY29yZEZpbHRlcnMiLCJmaWx0ZXJJZCIsInR5cGUiLCJsYWJlbCIsIm9wZXJhbmQiLCJJcyIsImRpc3BsYXlWYWx1ZSIsImZpZWxkTWV0YWRhdGFJZCIsInZhbHVlIiwicmVjb3JkRmlsdGVyR3JvdXBJZCIsInBvc2l0aW9uSW5SZWNvcmRGaWx0ZXJHcm91cCIsInNlbGVjdGFibGVMaXN0SWQiLCJob3RrZXlTY29wZSIsIlNpbmdsZVJlY29yZFBpY2tlciIsIml0ZW1zVG9TZWxlY3QiLCJpdGVtIiwic29tZSIsInNlbGVjdGVkIiwic2VsZWN0ZWRJdGVtcyIsIm9uQ2hhbmdlIiwic2VhcmNoRmlsdGVyIiwibG9hZGluZ0l0ZW1zIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsU0FBU0EsMEJBQTBCLFFBQVEsc0VBQXNFO0FBQ2pILFNBQVNDLGdEQUFnRCxRQUFRLGlHQUFpRztBQUNsSyxTQUFTQyw2Q0FBNkMsUUFBUSw4RkFBOEY7QUFDNUosU0FBU0MsbURBQW1ELFFBQVEsb0dBQW9HO0FBQ3hLLFNBQVNDLDRCQUE0QixRQUFRLDZFQUE2RTtBQUMxSCxTQUFTQyx1Q0FBdUMsUUFBUSx3RkFBd0Y7QUFDaEosU0FBU0MsZ0NBQWdDLFFBQVEsZ0ZBQWdGO0FBQ2pJLFNBQVNDLG9CQUFvQixRQUFRLDJEQUEyRDtBQUNoRyxTQUFTQyxrQ0FBa0MsUUFBUSwwRUFBMEU7QUFDN0gsU0FBU0MsbURBQW1ELFFBQVEsMEZBQTBGO0FBQzlKLFNBQVNDLDZCQUE2QixRQUFRLHlGQUF5RjtBQUN2SSxTQUFTQyxzQkFBc0IsUUFBUSwyREFBMkQ7QUFFbEcsU0FBU0MseUJBQXlCLFFBQVEsdUVBQXVFO0FBQ2pILFNBQVNDLDRCQUE0QixRQUFRLDBFQUEwRTtBQUN2SCxTQUFTQyxpQkFBaUIsUUFBUSxrQ0FBa0M7QUFDcEUsU0FBU0MsU0FBUyxRQUFRLHNCQUFzQjtBQUNoRCxTQUFTQyxFQUFFLFFBQVEsT0FBTztBQUUxQixPQUFPLE1BQU1DLHFCQUFxQixLQUFLO0FBQ3ZDLE9BQU8sTUFBTUMsdUJBQXVCLEVBQUU7QUFNdEMsT0FBTyxNQUFNQyxtQ0FBbUMsQ0FBQyxFQUMvQ0MsZUFBZSxFQUN1Qjs7SUFDdEMsTUFBTUMsa0NBQWtDVCwwQkFDdENWO0lBR0YsTUFBTW9CLDJDQUEyQ1QsNkJBQy9DVjtJQUdGLE1BQU1vQix3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