import { MAX_SEARCH_RESULTS } from "/src/modules/command-menu/constants/MaxSearchResults.ts";
import { search } from "/src/modules/command-menu/graphql/queries/search.ts";
import { usePerformCombinedFindManyRecords } from "/src/modules/object-record/multiple-objects/hooks/usePerformCombinedFindManyRecords.ts";
import { multipleRecordPickerPickableMorphItemsComponentState } from "/src/modules/object-record/record-picker/multiple-record-picker/states/multipleRecordPickerPickableMorphItemsComponentState.ts";
import { multipleRecordPickerSearchFilterComponentState } from "/src/modules/object-record/record-picker/multiple-record-picker/states/multipleRecordPickerSearchFilterComponentState.ts";
import { multipleRecordPickerSearchableObjectMetadataItemsComponentState } from "/src/modules/object-record/record-picker/multiple-record-picker/states/multipleRecordPickerSearchableObjectMetadataItemsComponentState.ts";
import { searchRecordStoreComponentFamilyState } from "/src/modules/object-record/record-picker/multiple-record-picker/states/searchRecordStoreComponentFamilyState.ts";
import { useApolloClient } from "/@fs/D:/twenty-table-o/node_modules/.vite/packages/twenty-front/deps/@apollo_client.js?v=226f7286";
import __vite__cjsImport8__sniptt_guards from "/@fs/D:/twenty-table-o/node_modules/.vite/packages/twenty-front/deps/@sniptt_guards.js?v=226f7286"; const isNonEmptyArray = __vite__cjsImport8__sniptt_guards["isNonEmptyArray"];
import { useRecoilCallback } from "/@fs/D:/twenty-table-o/node_modules/.vite/packages/twenty-front/deps/recoil.js?v=226f7286";
import { capitalize, isDefined } from "/@fs/D:/twenty-table-o/packages/twenty-shared/utils/dist/twenty-shared-utils.esm.js";
export const useMultipleRecordPickerPerformSearch = ()=>{
    const client = useApolloClient();
    const { performCombinedFindManyRecords } = usePerformCombinedFindManyRecords();
    const performSearch = useRecoilCallback(({ snapshot, set })=>async ({ multipleRecordPickerInstanceId, forceSearchFilter = '', forceSearchableObjectMetadataItems = [], forcePickableMorphItems = [] })=>{
            const { getLoadable } = snapshot;
            const recordPickerSearchFilter = getLoadable(multipleRecordPickerSearchFilterComponentState.atomFamily({
                instanceId: multipleRecordPickerInstanceId
            })).getValue();
            const searchFilter = forceSearchFilter ?? recordPickerSearchFilter;
            const recordPickerSearchableObjectMetadataItems = getLoadable(multipleRecordPickerSearchableObjectMetadataItemsComponentState.atomFamily({
                instanceId: multipleRecordPickerInstanceId
            })).getValue();
            const searchableObjectMetadataItems = forceSearchableObjectMetadataItems.length > 0 ? forceSearchableObjectMetadataItems : recordPickerSearchableObjectMetadataItems;
            const recordPickerPickableMorphItems = getLoadable(multipleRecordPickerPickableMorphItemsComponentState.atomFamily({
                instanceId: multipleRecordPickerInstanceId
            })).getValue();
            const pickableMorphItems = forcePickableMorphItems.length > 0 ? forcePickableMorphItems : recordPickerPickableMorphItems;
            const selectedPickableMorphItems = pickableMorphItems.filter(({ isSelected })=>isSelected);
            const [searchRecordsFilteredOnPickedRecords, searchRecordsExcludingPickedRecords] = await performSearchQueries({
                client,
                searchFilter,
                searchableObjectMetadataItems,
                pickedRecordIds: selectedPickableMorphItems.map(({ recordId })=>recordId)
            });
            const pickedMorphItems = pickableMorphItems.filter(({ isSelected })=>isSelected);
            // We update the existing pickedMorphItems to be matching the search filter
            const updatedPickedMorphItems = pickedMorphItems.map((morphItem)=>{
                const record = searchRecordsFilteredOnPickedRecords.find(({ recordId })=>recordId === morphItem.recordId);
                return {
                    ...morphItem,
                    isMatchingSearchFilter: isDefined(record)
                };
            });
            const searchRecordsFilteredOnPickedRecordsWithoutDuplicates = searchRecordsFilteredOnPickedRecords.filter((searchRecord)=>!updatedPickedMorphItems.some(({ recordId })=>recordId === searchRecord.recordId));
            const searchRecordsExcludingPickedRecordsWithoutDuplicates = searchRecordsExcludingPickedRecords.filter((searchRecord)=>!searchRecordsFilteredOnPickedRecords.some(({ recordId })=>recordId === searchRecord.recordId) && !pickedMorphItems.some(({ recordId })=>recordId === searchRecord.recordId));
            const morphItems = [
                ...updatedPickedMorphItems,
                ...searchRecordsFilteredOnPickedRecordsWithoutDuplicates.map(({ recordId, objectNameSingular })=>({
                        isMatchingSearchFilter: true,
                        isSelected: true,
                        objectMetadataId: searchableObjectMetadataItems.find((objectMetadata)=>objectMetadata.nameSingular === objectNameSingular)?.id,
                        recordId
                    })),
                ...searchRecordsExcludingPickedRecordsWithoutDuplicates.map(({ recordId, objectNameSingular })=>({
                        isMatchingSearchFilter: true,
                        isSelected: false,
                        objectMetadataId: searchableObjectMetadataItems.find((objectMetadata)=>objectMetadata.nameSingular === objectNameSingular)?.id,
                        recordId
                    }))
            ];
            set(multipleRecordPickerPickableMorphItemsComponentState.atomFamily({
                instanceId: multipleRecordPickerInstanceId
            }), morphItems);
            const searchRecords = [
                ...searchRecordsFilteredOnPickedRecords,
                ...searchRecordsExcludingPickedRecordsWithoutDuplicates
            ];
            searchRecords.forEach((searchRecord)=>{
                set(searchRecordStoreComponentFamilyState.atomFamily({
                    instanceId: multipleRecordPickerInstanceId,
                    familyKey: searchRecord.recordId
                }), searchRecord);
            });
            if (searchRecords.length > 0) {
                const filterPerMetadataItemFilteredOnRecordId = Object.fromEntries(searchableObjectMetadataItems.map(({ nameSingular })=>{
                    const recordIdsForMetadataItem = searchRecords.filter(({ objectNameSingular })=>objectNameSingular === nameSingular).map(({ recordId })=>recordId);
                    if (!isNonEmptyArray(recordIdsForMetadataItem)) {
                        return null;
                    }
                    return [
                        `filter${capitalize(nameSingular)}`,
                        {
                            id: {
                                in: recordIdsForMetadataItem
                            }
                        }
                    ];
                }).filter(isDefined));
                const operationSignatures = searchableObjectMetadataItems.filter(({ nameSingular })=>isDefined(filterPerMetadataItemFilteredOnRecordId[`filter${capitalize(nameSingular)}`])).map((objectMetadataItem)=>({
                        objectNameSingular: objectMetadataItem.nameSingular,
                        variables: {
                            filter: filterPerMetadataItemFilteredOnRecordId[`filter${capitalize(objectMetadataItem.nameSingular)}`]
                        }
                    }));
                performCombinedFindManyRecords({
                    operationSignatures
                }).then(({ result })=>{
                    Object.values(result).flat().forEach((objectRecord)=>{
                        const searchRecord = searchRecords.find(({ recordId })=>recordId === objectRecord.id);
                        if (!searchRecord) {
                            return;
                        }
                        set(searchRecordStoreComponentFamilyState.atomFamily({
                            instanceId: multipleRecordPickerInstanceId,
                            familyKey: objectRecord.id
                        }), {
                            ...searchRecord,
                            record: objectRecord
                        });
                    });
                });
            }
        }, [
        client,
        performCombinedFindManyRecords
    ]);
    return {
        performSearch
    };
};
const performSearchQueries = async ({ client, searchFilter, searchableObjectMetadataItems, pickedRecordIds })=>{
    if (searchableObjectMetadataItems.length === 0) {
        return [
            [],
            []
        ];
    }
    const searchRecords = async (filter)=>{
        const { data } = await client.query({
            query: search,
            variables: {
                searchInput: searchFilter,
                includedObjectNameSingulars: searchableObjectMetadataItems.map(({ nameSingular })=>nameSingular),
                filter,
                limit: MAX_SEARCH_RESULTS
            }
        });
        return data.search;
    };
    const searchRecordsExcludingPickedRecords = await searchRecords(pickedRecordIds.length > 0 ? {
        not: {
            id: {
                in: pickedRecordIds
            }
        }
    } : undefined);
    const searchRecordsIncludingPickedRecords = pickedRecordIds.length > 0 ? await searchRecords({
        id: {
            in: pickedRecordIds
        }
    }) : [];
    return [
        searchRecordsIncludingPickedRecords,
        searchRecordsExcludingPickedRecords
    ];
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZU11bHRpcGxlUmVjb3JkUGlja2VyUGVyZm9ybVNlYXJjaC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNQVhfU0VBUkNIX1JFU1VMVFMgfSBmcm9tICdAL2NvbW1hbmQtbWVudS9jb25zdGFudHMvTWF4U2VhcmNoUmVzdWx0cyc7XG5pbXBvcnQgeyBzZWFyY2ggfSBmcm9tICdAL2NvbW1hbmQtbWVudS9ncmFwaHFsL3F1ZXJpZXMvc2VhcmNoJztcbmltcG9ydCB7IE9iamVjdE1ldGFkYXRhSXRlbSB9IGZyb20gJ0Avb2JqZWN0LW1ldGFkYXRhL3R5cGVzL09iamVjdE1ldGFkYXRhSXRlbSc7XG5pbXBvcnQgeyB1c2VQZXJmb3JtQ29tYmluZWRGaW5kTWFueVJlY29yZHMgfSBmcm9tICdAL29iamVjdC1yZWNvcmQvbXVsdGlwbGUtb2JqZWN0cy9ob29rcy91c2VQZXJmb3JtQ29tYmluZWRGaW5kTWFueVJlY29yZHMnO1xuaW1wb3J0IHsgbXVsdGlwbGVSZWNvcmRQaWNrZXJQaWNrYWJsZU1vcnBoSXRlbXNDb21wb25lbnRTdGF0ZSB9IGZyb20gJ0Avb2JqZWN0LXJlY29yZC9yZWNvcmQtcGlja2VyL211bHRpcGxlLXJlY29yZC1waWNrZXIvc3RhdGVzL211bHRpcGxlUmVjb3JkUGlja2VyUGlja2FibGVNb3JwaEl0ZW1zQ29tcG9uZW50U3RhdGUnO1xuaW1wb3J0IHsgbXVsdGlwbGVSZWNvcmRQaWNrZXJTZWFyY2hGaWx0ZXJDb21wb25lbnRTdGF0ZSB9IGZyb20gJ0Avb2JqZWN0LXJlY29yZC9yZWNvcmQtcGlja2VyL211bHRpcGxlLXJlY29yZC1waWNrZXIvc3RhdGVzL211bHRpcGxlUmVjb3JkUGlja2VyU2VhcmNoRmlsdGVyQ29tcG9uZW50U3RhdGUnO1xuaW1wb3J0IHsgbXVsdGlwbGVSZWNvcmRQaWNrZXJTZWFyY2hhYmxlT2JqZWN0TWV0YWRhdGFJdGVtc0NvbXBvbmVudFN0YXRlIH0gZnJvbSAnQC9vYmplY3QtcmVjb3JkL3JlY29yZC1waWNrZXIvbXVsdGlwbGUtcmVjb3JkLXBpY2tlci9zdGF0ZXMvbXVsdGlwbGVSZWNvcmRQaWNrZXJTZWFyY2hhYmxlT2JqZWN0TWV0YWRhdGFJdGVtc0NvbXBvbmVudFN0YXRlJztcbmltcG9ydCB7IHNlYXJjaFJlY29yZFN0b3JlQ29tcG9uZW50RmFtaWx5U3RhdGUgfSBmcm9tICdAL29iamVjdC1yZWNvcmQvcmVjb3JkLXBpY2tlci9tdWx0aXBsZS1yZWNvcmQtcGlja2VyL3N0YXRlcy9zZWFyY2hSZWNvcmRTdG9yZUNvbXBvbmVudEZhbWlseVN0YXRlJztcbmltcG9ydCB7IFJlY29yZFBpY2tlclBpY2thYmxlTW9ycGhJdGVtIH0gZnJvbSAnQC9vYmplY3QtcmVjb3JkL3JlY29yZC1waWNrZXIvdHlwZXMvUmVjb3JkUGlja2VyUGlja2FibGVNb3JwaEl0ZW0nO1xuaW1wb3J0IHsgQXBvbGxvQ2xpZW50LCB1c2VBcG9sbG9DbGllbnQgfSBmcm9tICdAYXBvbGxvL2NsaWVudCc7XG5pbXBvcnQgeyBpc05vbkVtcHR5QXJyYXkgfSBmcm9tICdAc25pcHR0L2d1YXJkcyc7XG5pbXBvcnQgeyB1c2VSZWNvaWxDYWxsYmFjayB9IGZyb20gJ3JlY29pbCc7XG5pbXBvcnQgeyBjYXBpdGFsaXplLCBpc0RlZmluZWQgfSBmcm9tICd0d2VudHktc2hhcmVkL3V0aWxzJztcbmltcG9ydCB7IFNlYXJjaFJlY29yZCB9IGZyb20gJ34vZ2VuZXJhdGVkLW1ldGFkYXRhL2dyYXBocWwnO1xuXG5leHBvcnQgY29uc3QgdXNlTXVsdGlwbGVSZWNvcmRQaWNrZXJQZXJmb3JtU2VhcmNoID0gKCkgPT4ge1xuICBjb25zdCBjbGllbnQgPSB1c2VBcG9sbG9DbGllbnQoKTtcblxuICBjb25zdCB7IHBlcmZvcm1Db21iaW5lZEZpbmRNYW55UmVjb3JkcyB9ID1cbiAgICB1c2VQZXJmb3JtQ29tYmluZWRGaW5kTWFueVJlY29yZHMoKTtcblxuICBjb25zdCBwZXJmb3JtU2VhcmNoID0gdXNlUmVjb2lsQ2FsbGJhY2soXG4gICAgKHsgc25hcHNob3QsIHNldCB9KSA9PlxuICAgICAgYXN5bmMgKHtcbiAgICAgICAgbXVsdGlwbGVSZWNvcmRQaWNrZXJJbnN0YW5jZUlkLFxuICAgICAgICBmb3JjZVNlYXJjaEZpbHRlciA9ICcnLFxuICAgICAgICBmb3JjZVNlYXJjaGFibGVPYmplY3RNZXRhZGF0YUl0ZW1zID0gW10sXG4gICAgICAgIGZvcmNlUGlja2FibGVNb3JwaEl0ZW1zID0gW10sXG4gICAgICB9OiB7XG4gICAgICAgIG11bHRpcGxlUmVjb3JkUGlja2VySW5zdGFuY2VJZDogc3RyaW5nO1xuICAgICAgICBmb3JjZVNlYXJjaEZpbHRlcj86IHN0cmluZztcbiAgICAgICAgZm9yY2VTZWFyY2hhYmxlT2JqZWN0TWV0YWRhdGFJdGVtcz86IE9iamVjdE1ldGFkYXRhSXRlbVtdO1xuICAgICAgICBmb3JjZVBpY2thYmxlTW9ycGhJdGVtcz86IFJlY29yZFBpY2tlclBpY2thYmxlTW9ycGhJdGVtW107XG4gICAgICB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgZ2V0TG9hZGFibGUgfSA9IHNuYXBzaG90O1xuXG4gICAgICAgIGNvbnN0IHJlY29yZFBpY2tlclNlYXJjaEZpbHRlciA9IGdldExvYWRhYmxlKFxuICAgICAgICAgIG11bHRpcGxlUmVjb3JkUGlja2VyU2VhcmNoRmlsdGVyQ29tcG9uZW50U3RhdGUuYXRvbUZhbWlseSh7XG4gICAgICAgICAgICBpbnN0YW5jZUlkOiBtdWx0aXBsZVJlY29yZFBpY2tlckluc3RhbmNlSWQsXG4gICAgICAgICAgfSksXG4gICAgICAgICkuZ2V0VmFsdWUoKTtcblxuICAgICAgICBjb25zdCBzZWFyY2hGaWx0ZXIgPSBmb3JjZVNlYXJjaEZpbHRlciA/PyByZWNvcmRQaWNrZXJTZWFyY2hGaWx0ZXI7XG5cbiAgICAgICAgY29uc3QgcmVjb3JkUGlja2VyU2VhcmNoYWJsZU9iamVjdE1ldGFkYXRhSXRlbXMgPSBnZXRMb2FkYWJsZShcbiAgICAgICAgICBtdWx0aXBsZVJlY29yZFBpY2tlclNlYXJjaGFibGVPYmplY3RNZXRhZGF0YUl0ZW1zQ29tcG9uZW50U3RhdGUuYXRvbUZhbWlseShcbiAgICAgICAgICAgIHsgaW5zdGFuY2VJZDogbXVsdGlwbGVSZWNvcmRQaWNrZXJJbnN0YW5jZUlkIH0sXG4gICAgICAgICAgKSxcbiAgICAgICAgKS5nZXRWYWx1ZSgpO1xuXG4gICAgICAgIGNvbnN0IHNlYXJjaGFibGVPYmplY3RNZXRhZGF0YUl0ZW1zID1cbiAgICAgICAgICBmb3JjZVNlYXJjaGFibGVPYmplY3RNZXRhZGF0YUl0ZW1zLmxlbmd0aCA+IDBcbiAgICAgICAgICAgID8gZm9yY2VTZWFyY2hhYmxlT2JqZWN0TWV0YWRhdGFJdGVtc1xuICAgICAgICAgICAgOiByZWNvcmRQaWNrZXJTZWFyY2hhYmxlT2JqZWN0TWV0YWRhdGFJdGVtcztcblxuICAgICAgICBjb25zdCByZWNvcmRQaWNrZXJQaWNrYWJsZU1vcnBoSXRlbXMgPSBnZXRMb2FkYWJsZShcbiAgICAgICAgICBtdWx0aXBsZVJlY29yZFBpY2tlclBpY2thYmxlTW9ycGhJdGVtc0NvbXBvbmVudFN0YXRlLmF0b21GYW1pbHkoe1xuICAgICAgICAgICAgaW5zdGFuY2VJZDogbXVsdGlwbGVSZWNvcmRQaWNrZXJJbnN0YW5jZUlkLFxuICAgICAgICAgIH0pLFxuICAgICAgICApLmdldFZhbHVlKCk7XG5cbiAgICAgICAgY29uc3QgcGlja2FibGVNb3JwaEl0ZW1zID1cbiAgICAgICAgICBmb3JjZVBpY2thYmxlTW9ycGhJdGVtcy5sZW5ndGggPiAwXG4gICAgICAgICAgICA/IGZvcmNlUGlja2FibGVNb3JwaEl0ZW1zXG4gICAgICAgICAgICA6IHJlY29yZFBpY2tlclBpY2thYmxlTW9ycGhJdGVtcztcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRQaWNrYWJsZU1vcnBoSXRlbXMgPSBwaWNrYWJsZU1vcnBoSXRlbXMuZmlsdGVyKFxuICAgICAgICAgICh7IGlzU2VsZWN0ZWQgfSkgPT4gaXNTZWxlY3RlZCxcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBbXG4gICAgICAgICAgc2VhcmNoUmVjb3Jkc0ZpbHRlcmVkT25QaWNrZWRSZWNvcmRzLFxuICAgICAgICAgIHNlYXJjaFJlY29yZHNFeGNsdWRpbmdQaWNrZWRSZWNvcmRzLFxuICAgICAgICBdID0gYXdhaXQgcGVyZm9ybVNlYXJjaFF1ZXJpZXMoe1xuICAgICAgICAgIGNsaWVudCxcbiAgICAgICAgICBzZWFyY2hGaWx0ZXIsXG4gICAgICAgICAgc2VhcmNoYWJsZU9iamVjdE1ldGFkYXRhSXRlbXMsXG4gICAgICAgICAgcGlja2VkUmVjb3JkSWRzOiBzZWxlY3RlZFBpY2thYmxlTW9ycGhJdGVtcy5tYXAoXG4gICAgICAgICAgICAoeyByZWNvcmRJZCB9KSA9PiByZWNvcmRJZCxcbiAgICAgICAgICApLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBwaWNrZWRNb3JwaEl0ZW1zID0gcGlja2FibGVNb3JwaEl0ZW1zLmZpbHRlcihcbiAgICAgICAgICAoeyBpc1NlbGVjdGVkIH0pID0+IGlzU2VsZWN0ZWQsXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gV2UgdXBkYXRlIHRoZSBleGlzdGluZyBwaWNrZWRNb3JwaEl0ZW1zIHRvIGJlIG1hdGNoaW5nIHRoZSBzZWFyY2ggZmlsdGVyXG4gICAgICAgIGNvbnN0IHVwZGF0ZWRQaWNrZWRNb3JwaEl0ZW1zID0gcGlja2VkTW9ycGhJdGVtcy5tYXAoKG1vcnBoSXRlbSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHJlY29yZCA9IHNlYXJjaFJlY29yZHNGaWx0ZXJlZE9uUGlja2VkUmVjb3Jkcy5maW5kKFxuICAgICAgICAgICAgKHsgcmVjb3JkSWQgfSkgPT4gcmVjb3JkSWQgPT09IG1vcnBoSXRlbS5yZWNvcmRJZCxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLm1vcnBoSXRlbSxcbiAgICAgICAgICAgIGlzTWF0Y2hpbmdTZWFyY2hGaWx0ZXI6IGlzRGVmaW5lZChyZWNvcmQpLFxuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHNlYXJjaFJlY29yZHNGaWx0ZXJlZE9uUGlja2VkUmVjb3Jkc1dpdGhvdXREdXBsaWNhdGVzID1cbiAgICAgICAgICBzZWFyY2hSZWNvcmRzRmlsdGVyZWRPblBpY2tlZFJlY29yZHMuZmlsdGVyKFxuICAgICAgICAgICAgKHNlYXJjaFJlY29yZCkgPT5cbiAgICAgICAgICAgICAgIXVwZGF0ZWRQaWNrZWRNb3JwaEl0ZW1zLnNvbWUoXG4gICAgICAgICAgICAgICAgKHsgcmVjb3JkSWQgfSkgPT4gcmVjb3JkSWQgPT09IHNlYXJjaFJlY29yZC5yZWNvcmRJZCxcbiAgICAgICAgICAgICAgKSxcbiAgICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHNlYXJjaFJlY29yZHNFeGNsdWRpbmdQaWNrZWRSZWNvcmRzV2l0aG91dER1cGxpY2F0ZXMgPVxuICAgICAgICAgIHNlYXJjaFJlY29yZHNFeGNsdWRpbmdQaWNrZWRSZWNvcmRzLmZpbHRlcihcbiAgICAgICAgICAgIChzZWFyY2hSZWNvcmQpID0+XG4gICAgICAgICAgICAgICFzZWFyY2hSZWNvcmRzRmlsdGVyZWRPblBpY2tlZFJlY29yZHMuc29tZShcbiAgICAgICAgICAgICAgICAoeyByZWNvcmRJZCB9KSA9PiByZWNvcmRJZCA9PT0gc2VhcmNoUmVjb3JkLnJlY29yZElkLFxuICAgICAgICAgICAgICApICYmXG4gICAgICAgICAgICAgICFwaWNrZWRNb3JwaEl0ZW1zLnNvbWUoXG4gICAgICAgICAgICAgICAgKHsgcmVjb3JkSWQgfSkgPT4gcmVjb3JkSWQgPT09IHNlYXJjaFJlY29yZC5yZWNvcmRJZCxcbiAgICAgICAgICAgICAgKSxcbiAgICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IG1vcnBoSXRlbXMgPSBbXG4gICAgICAgICAgLi4udXBkYXRlZFBpY2tlZE1vcnBoSXRlbXMsXG4gICAgICAgICAgLi4uc2VhcmNoUmVjb3Jkc0ZpbHRlcmVkT25QaWNrZWRSZWNvcmRzV2l0aG91dER1cGxpY2F0ZXMubWFwKFxuICAgICAgICAgICAgKHsgcmVjb3JkSWQsIG9iamVjdE5hbWVTaW5ndWxhciB9KSA9PiAoe1xuICAgICAgICAgICAgICBpc01hdGNoaW5nU2VhcmNoRmlsdGVyOiB0cnVlLFxuICAgICAgICAgICAgICBpc1NlbGVjdGVkOiB0cnVlLFxuICAgICAgICAgICAgICBvYmplY3RNZXRhZGF0YUlkOiBzZWFyY2hhYmxlT2JqZWN0TWV0YWRhdGFJdGVtcy5maW5kKFxuICAgICAgICAgICAgICAgIChvYmplY3RNZXRhZGF0YSkgPT5cbiAgICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhLm5hbWVTaW5ndWxhciA9PT0gb2JqZWN0TmFtZVNpbmd1bGFyLFxuICAgICAgICAgICAgICApPy5pZCxcbiAgICAgICAgICAgICAgcmVjb3JkSWQsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICApLFxuICAgICAgICAgIC4uLnNlYXJjaFJlY29yZHNFeGNsdWRpbmdQaWNrZWRSZWNvcmRzV2l0aG91dER1cGxpY2F0ZXMubWFwKFxuICAgICAgICAgICAgKHsgcmVjb3JkSWQsIG9iamVjdE5hbWVTaW5ndWxhciB9KSA9PiAoe1xuICAgICAgICAgICAgICBpc01hdGNoaW5nU2VhcmNoRmlsdGVyOiB0cnVlLFxuICAgICAgICAgICAgICBpc1NlbGVjdGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGFJZDogc2VhcmNoYWJsZU9iamVjdE1ldGFkYXRhSXRlbXMuZmluZChcbiAgICAgICAgICAgICAgICAob2JqZWN0TWV0YWRhdGEpID0+XG4gICAgICAgICAgICAgICAgICBvYmplY3RNZXRhZGF0YS5uYW1lU2luZ3VsYXIgPT09IG9iamVjdE5hbWVTaW5ndWxhcixcbiAgICAgICAgICAgICAgKT8uaWQsXG4gICAgICAgICAgICAgIHJlY29yZElkLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgKSxcbiAgICAgICAgXTtcblxuICAgICAgICBzZXQoXG4gICAgICAgICAgbXVsdGlwbGVSZWNvcmRQaWNrZXJQaWNrYWJsZU1vcnBoSXRlbXNDb21wb25lbnRTdGF0ZS5hdG9tRmFtaWx5KHtcbiAgICAgICAgICAgIGluc3RhbmNlSWQ6IG11bHRpcGxlUmVjb3JkUGlja2VySW5zdGFuY2VJZCxcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBtb3JwaEl0ZW1zLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHNlYXJjaFJlY29yZHMgPSBbXG4gICAgICAgICAgLi4uc2VhcmNoUmVjb3Jkc0ZpbHRlcmVkT25QaWNrZWRSZWNvcmRzLFxuICAgICAgICAgIC4uLnNlYXJjaFJlY29yZHNFeGNsdWRpbmdQaWNrZWRSZWNvcmRzV2l0aG91dER1cGxpY2F0ZXMsXG4gICAgICAgIF07XG5cbiAgICAgICAgc2VhcmNoUmVjb3Jkcy5mb3JFYWNoKChzZWFyY2hSZWNvcmQpID0+IHtcbiAgICAgICAgICBzZXQoXG4gICAgICAgICAgICBzZWFyY2hSZWNvcmRTdG9yZUNvbXBvbmVudEZhbWlseVN0YXRlLmF0b21GYW1pbHkoe1xuICAgICAgICAgICAgICBpbnN0YW5jZUlkOiBtdWx0aXBsZVJlY29yZFBpY2tlckluc3RhbmNlSWQsXG4gICAgICAgICAgICAgIGZhbWlseUtleTogc2VhcmNoUmVjb3JkLnJlY29yZElkLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBzZWFyY2hSZWNvcmQsXG4gICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHNlYXJjaFJlY29yZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IGZpbHRlclBlck1ldGFkYXRhSXRlbUZpbHRlcmVkT25SZWNvcmRJZCA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICAgICAgICAgIHNlYXJjaGFibGVPYmplY3RNZXRhZGF0YUl0ZW1zXG4gICAgICAgICAgICAgIC5tYXAoKHsgbmFtZVNpbmd1bGFyIH0pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZWNvcmRJZHNGb3JNZXRhZGF0YUl0ZW0gPSBzZWFyY2hSZWNvcmRzXG4gICAgICAgICAgICAgICAgICAuZmlsdGVyKFxuICAgICAgICAgICAgICAgICAgICAoeyBvYmplY3ROYW1lU2luZ3VsYXIgfSkgPT5cbiAgICAgICAgICAgICAgICAgICAgICBvYmplY3ROYW1lU2luZ3VsYXIgPT09IG5hbWVTaW5ndWxhcixcbiAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgIC5tYXAoKHsgcmVjb3JkSWQgfSkgPT4gcmVjb3JkSWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFpc05vbkVtcHR5QXJyYXkocmVjb3JkSWRzRm9yTWV0YWRhdGFJdGVtKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICAgIGBmaWx0ZXIke2NhcGl0YWxpemUobmFtZVNpbmd1bGFyKX1gLFxuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZDoge1xuICAgICAgICAgICAgICAgICAgICAgIGluOiByZWNvcmRJZHNGb3JNZXRhZGF0YUl0ZW0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC5maWx0ZXIoaXNEZWZpbmVkKSxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgY29uc3Qgb3BlcmF0aW9uU2lnbmF0dXJlcyA9IHNlYXJjaGFibGVPYmplY3RNZXRhZGF0YUl0ZW1zXG4gICAgICAgICAgICAuZmlsdGVyKCh7IG5hbWVTaW5ndWxhciB9KSA9PlxuICAgICAgICAgICAgICBpc0RlZmluZWQoXG4gICAgICAgICAgICAgICAgZmlsdGVyUGVyTWV0YWRhdGFJdGVtRmlsdGVyZWRPblJlY29yZElkW1xuICAgICAgICAgICAgICAgICAgYGZpbHRlciR7Y2FwaXRhbGl6ZShuYW1lU2luZ3VsYXIpfWBcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLm1hcCgob2JqZWN0TWV0YWRhdGFJdGVtKSA9PiAoe1xuICAgICAgICAgICAgICBvYmplY3ROYW1lU2luZ3VsYXI6IG9iamVjdE1ldGFkYXRhSXRlbS5uYW1lU2luZ3VsYXIsXG4gICAgICAgICAgICAgIHZhcmlhYmxlczoge1xuICAgICAgICAgICAgICAgIGZpbHRlcjpcbiAgICAgICAgICAgICAgICAgIGZpbHRlclBlck1ldGFkYXRhSXRlbUZpbHRlcmVkT25SZWNvcmRJZFtcbiAgICAgICAgICAgICAgICAgICAgYGZpbHRlciR7Y2FwaXRhbGl6ZShvYmplY3RNZXRhZGF0YUl0ZW0ubmFtZVNpbmd1bGFyKX1gXG4gICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgcGVyZm9ybUNvbWJpbmVkRmluZE1hbnlSZWNvcmRzKHsgb3BlcmF0aW9uU2lnbmF0dXJlcyB9KS50aGVuKFxuICAgICAgICAgICAgKHsgcmVzdWx0IH0pID0+IHtcbiAgICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyhyZXN1bHQpXG4gICAgICAgICAgICAgICAgLmZsYXQoKVxuICAgICAgICAgICAgICAgIC5mb3JFYWNoKChvYmplY3RSZWNvcmQpID0+IHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHNlYXJjaFJlY29yZCA9IHNlYXJjaFJlY29yZHMuZmluZChcbiAgICAgICAgICAgICAgICAgICAgKHsgcmVjb3JkSWQgfSkgPT4gcmVjb3JkSWQgPT09IG9iamVjdFJlY29yZC5pZCxcbiAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgIGlmICghc2VhcmNoUmVjb3JkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgc2V0KFxuICAgICAgICAgICAgICAgICAgICBzZWFyY2hSZWNvcmRTdG9yZUNvbXBvbmVudEZhbWlseVN0YXRlLmF0b21GYW1pbHkoe1xuICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlSWQ6IG11bHRpcGxlUmVjb3JkUGlja2VySW5zdGFuY2VJZCxcbiAgICAgICAgICAgICAgICAgICAgICBmYW1pbHlLZXk6IG9iamVjdFJlY29yZC5pZCxcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAuLi5zZWFyY2hSZWNvcmQsXG4gICAgICAgICAgICAgICAgICAgICAgcmVjb3JkOiBvYmplY3RSZWNvcmQsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIFtjbGllbnQsIHBlcmZvcm1Db21iaW5lZEZpbmRNYW55UmVjb3Jkc10sXG4gICk7XG5cbiAgcmV0dXJuIHsgcGVyZm9ybVNlYXJjaCB9O1xufTtcblxuY29uc3QgcGVyZm9ybVNlYXJjaFF1ZXJpZXMgPSBhc3luYyAoe1xuICBjbGllbnQsXG4gIHNlYXJjaEZpbHRlcixcbiAgc2VhcmNoYWJsZU9iamVjdE1ldGFkYXRhSXRlbXMsXG4gIHBpY2tlZFJlY29yZElkcyxcbn06IHtcbiAgY2xpZW50OiBBcG9sbG9DbGllbnQ8b2JqZWN0PjtcbiAgc2VhcmNoRmlsdGVyOiBzdHJpbmc7XG4gIHNlYXJjaGFibGVPYmplY3RNZXRhZGF0YUl0ZW1zOiBPYmplY3RNZXRhZGF0YUl0ZW1bXTtcbiAgcGlja2VkUmVjb3JkSWRzOiBzdHJpbmdbXTtcbn0pOiBQcm9taXNlPFtTZWFyY2hSZWNvcmRbXSwgU2VhcmNoUmVjb3JkW11dPiA9PiB7XG4gIGlmIChzZWFyY2hhYmxlT2JqZWN0TWV0YWRhdGFJdGVtcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gW1tdLCBbXV07XG4gIH1cblxuICBjb25zdCBzZWFyY2hSZWNvcmRzID0gYXN5bmMgKGZpbHRlcjogYW55KSA9PiB7XG4gICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBjbGllbnQucXVlcnkoe1xuICAgICAgcXVlcnk6IHNlYXJjaCxcbiAgICAgIHZhcmlhYmxlczoge1xuICAgICAgICBzZWFyY2hJbnB1dDogc2VhcmNoRmlsdGVyLFxuICAgICAgICBpbmNsdWRlZE9iamVjdE5hbWVTaW5ndWxhcnM6IHNlYXJjaGFibGVPYmplY3RNZXRhZGF0YUl0ZW1zLm1hcChcbiAgICAgICAgICAoeyBuYW1lU2luZ3VsYXIgfSkgPT4gbmFtZVNpbmd1bGFyLFxuICAgICAgICApLFxuICAgICAgICBmaWx0ZXIsXG4gICAgICAgIGxpbWl0OiBNQVhfU0VBUkNIX1JFU1VMVFMsXG4gICAgICB9LFxuICAgIH0pO1xuICAgIHJldHVybiBkYXRhLnNlYXJjaDtcbiAgfTtcblxuICBjb25zdCBzZWFyY2hSZWNvcmRzRXhjbHVkaW5nUGlja2VkUmVjb3JkcyA9IGF3YWl0IHNlYXJjaFJlY29yZHMoXG4gICAgcGlja2VkUmVjb3JkSWRzLmxlbmd0aCA+IDBcbiAgICAgID8ge1xuICAgICAgICAgIG5vdDoge1xuICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgaW46IHBpY2tlZFJlY29yZElkcyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgICAgOiB1bmRlZmluZWQsXG4gICk7XG5cbiAgY29uc3Qgc2VhcmNoUmVjb3Jkc0luY2x1ZGluZ1BpY2tlZFJlY29yZHMgPVxuICAgIHBpY2tlZFJlY29yZElkcy5sZW5ndGggPiAwXG4gICAgICA/IGF3YWl0IHNlYXJjaFJlY29yZHMoe1xuICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICBpbjogcGlja2VkUmVjb3JkSWRzLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pXG4gICAgICA6IFtdO1xuXG4gIHJldHVybiBbXG4gICAgc2VhcmNoUmVjb3Jkc0luY2x1ZGluZ1BpY2tlZFJlY29yZHMsXG4gICAgc2VhcmNoUmVjb3Jkc0V4Y2x1ZGluZ1BpY2tlZFJlY29yZHMsXG4gIF07XG59O1xuIl0sIm5hbWVzIjpbIk1BWF9TRUFSQ0hfUkVTVUxUUyIsInNlYXJjaCIsInVzZVBlcmZvcm1Db21iaW5lZEZpbmRNYW55UmVjb3JkcyIsIm11bHRpcGxlUmVjb3JkUGlja2VyUGlja2FibGVNb3JwaEl0ZW1zQ29tcG9uZW50U3RhdGUiLCJtdWx0aXBsZVJlY29yZFBpY2tlclNlYXJjaEZpbHRlckNvbXBvbmVudFN0YXRlIiwibXVsdGlwbGVSZWNvcmRQaWNrZXJTZWFyY2hhYmxlT2JqZWN0TWV0YWRhdGFJdGVtc0NvbXBvbmVudFN0YXRlIiwic2VhcmNoUmVjb3JkU3RvcmVDb21wb25lbnRGYW1pbHlTdGF0ZSIsInVzZUFwb2xsb0NsaWVudCIsImlzTm9uRW1wdHlBcnJheSIsInVzZVJlY29pbENhbGxiYWNrIiwiY2FwaXRhbGl6ZSIsImlzRGVmaW5lZCIsInVzZU11bHRpcGxlUmVjb3JkUGlja2VyUGVyZm9ybVNlYXJjaCIsImNsaWVudCIsInBlcmZvcm1Db21iaW5lZEZpbmRNYW55UmVjb3JkcyIsInBlcmZvcm1TZWFyY2giLCJzbmFwc2hvdCIsInNldCIsIm11bHRpcGxlUmVjb3JkUGlja2VySW5zdGFuY2VJZCIsImZvcmNlU2VhcmNoRmlsdGVyIiwiZm9yY2VTZWFyY2hhYmxlT2JqZWN0TWV0YWRhdGFJdGVtcyIsImZvcmNlUGlja2FibGVNb3JwaEl0ZW1zIiwiZ2V0TG9hZGFibGUiLCJyZWNvcmRQaWNrZXJTZWFyY2hGaWx0ZXIiLCJhdG9tRmFtaWx5IiwiaW5zdGFuY2VJZCIsImdldFZhbHVlIiwic2VhcmNoRmlsdGVyIiwicmVjb3JkUGlja2VyU2VhcmNoYWJsZU9iamVjdE1ldGFkYXRhSXRlbXMiLCJzZWFyY2hhYmxlT2JqZWN0TWV0YWRhdGFJdGVtcyIsImxlbmd0aCIsInJlY29yZFBpY2tlclBpY2thYmxlTW9ycGhJdGVtcyIsInBpY2thYmxlTW9ycGhJdGVtcyIsInNlbGVjdGVkUGlja2FibGVNb3JwaEl0ZW1zIiwiZmlsdGVyIiwiaXNTZWxlY3RlZCIsInNlYXJjaFJlY29yZHNGaWx0ZXJlZE9uUGlja2VkUmVjb3JkcyIsInNlYXJjaFJlY29yZHNFeGNsdWRpbmdQaWNrZWRSZWNvcmRzIiwicGVyZm9ybVNlYXJjaFF1ZXJpZXMiLCJwaWNrZWRSZWNvcmRJZHMiLCJtYXAiLCJyZWNvcmRJZCIsInBpY2tlZE1vcnBoSXRlbXMiLCJ1cGRhdGVkUGlja2VkTW9ycGhJdGVtcyIsIm1vcnBoSXRlbSIsInJlY29yZCIsImZpbmQiLCJpc01hdGNoaW5nU2VhcmNoRmlsdGVyIiwic2VhcmNoUmVjb3Jkc0ZpbHRlcmVkT25QaWNrZWRSZWNvcmRzV2l0aG91dER1cGxpY2F0ZXMiLCJzZWFyY2hSZWNvcmQiLCJzb21lIiwic2VhcmNoUmVjb3Jkc0V4Y2x1ZGluZ1BpY2tlZFJlY29yZHNXaXRob3V0RHVwbGljYXRlcyIsIm1vcnBoSXRlbXMiLCJvYmplY3ROYW1lU2luZ3VsYXIiLCJvYmplY3RNZXRhZGF0YUlkIiwib2JqZWN0TWV0YWRhdGEiLCJuYW1lU2luZ3VsYXIiLCJpZCIsInNlYXJjaFJlY29yZHMiLCJmb3JFYWNoIiwiZmFtaWx5S2V5IiwiZmlsdGVyUGVyTWV0YWRhdGFJdGVtRmlsdGVyZWRPblJlY29yZElkIiwiT2JqZWN0IiwiZnJvbUVudHJpZXMiLCJyZWNvcmRJZHNGb3JNZXRhZGF0YUl0ZW0iLCJpbiIsIm9wZXJhdGlvblNpZ25hdHVyZXMiLCJvYmplY3RNZXRhZGF0YUl0ZW0iLCJ2YXJpYWJsZXMiLCJ0aGVuIiwicmVzdWx0IiwidmFsdWVzIiwiZmxhdCIsIm9iamVjdFJlY29yZCIsImRhdGEiLCJxdWVyeSIsInNlYXJjaElucHV0IiwiaW5jbHVkZWRPYmplY3ROYW1lU2luZ3VsYXJzIiwibGltaXQi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